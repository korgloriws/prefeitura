import streamlit as st
import xlwings as xw
import os
import tempfile

def main():
    st.title('RREO-02-Integrador')

   
    arquivo_xls_origem = st.file_uploader('Relatório sicof', type=['xls', 'xlsx'])
    arquivo_xls_destino = st.file_uploader('planilha vazia do siconfi', type=['xls', 'xlsx'])

    nome_arquivo_copia = st.text_input('Nome do arquivo de cópia:', 'RREO-02.xls')

    if st.button('Transferir Dados') and arquivo_xls_origem and arquivo_xls_destino:
        with tempfile.NamedTemporaryFile(delete=False, suffix='.xls') as tmp_origem:
            tmp_origem.write(arquivo_xls_origem.getvalue())
            caminho_xls_origem = tmp_origem.name

        with tempfile.NamedTemporaryFile(delete=False, suffix='.xls') as tmp_destino:
            tmp_destino.write(arquivo_xls_destino.getvalue())
            caminho_xls_original = tmp_destino.name

        caminho_pasta = tempfile.gettempdir()
        caminho_xls_copia = os.path.join(caminho_pasta, nome_arquivo_copia)

       
        app = xw.App(visible=False)
        wb_destino = app.books.open(caminho_xls_original)
        sheet_destino = wb_destino.sheets['RREO-Anexo 02']

        
        wb_origem = app.books.open(caminho_xls_origem)
        sheet_origem = wb_origem.sheets[0]  

       
        for origem, destino in mapeamento.items():
            valor = sheet_origem.range(origem).value
            sheet_destino.range(destino).value = valor

        
        wb_destino.save(caminho_xls_copia)
        wb_destino.close()
        wb_origem.close()
        app.quit()

      
        with open(caminho_xls_copia, "rb") as file:
            btn = st.download_button(
                label="Download arquivo copiado",
                data=file,
                file_name=nome_arquivo_copia,
                mime="application/vnd.ms-excel"
            )
        st.success('Dados transferidos com sucesso.')

mapeamento = {
"D2":"B21",
"E2":"C21",
"F2":"D21",
"H2":"E21",
"J2":"H21",
"L2":"I21",
"D3":"B32",
"E3":"C32",
"F3":"D32",
"H3":"E32",
"J3":"H32",
"L3":"I32",
"D4":"B33",
"E4":"C33",
"F4":"D33",
"H4":"E33",
"J4":"H33",
"L4":"I33",
"D5":"B36",
"E5":"C36",
"F5":"D36",
"H5":"E36",
"J5":"H36",
"L5":"I36",
"D6":"B37",
"E6":"C37",
"F6":"D37",
"H6":"E37",
"J6":"H37",
"L6":"I37",
"D7":"B38",
"E7":"C38",
"F7":"D38",
"H7":"E38",
"J7":"H38",
"L7":"I38",
"D8":"B39",
"E8":"C39",
"F8":"D39",
"H8":"E39",
"J8":"H39",
"L8":"I39",
"D9":"B41",
"E9":"C41",
"F9":"D41",
"H9":"E41",
"J9":"H41",
"L9":"I41",
"D10":"B43",
"E10":"C43",
"F10":"D43",
"H10":"E43",
"J10":"H43",
"L10":"I43",
"D11":"B46",
"E11":"C46",
"F11":"D46",
"H11":"E46",
"J11":"H46",
"L11":"I46",
"D12":"B47",
"E12":"C47",
"F12":"D47",
"H12":"E47",
"J12":"H47",
"L12":"I47",
"D13":"B58",
"E13":"C58",
"F13":"D58",
"H13":"E58",
"J13":"H58",
"L13":"I58",
"D14":"B55",
"E14":"C55",
"F14":"D55",
"H14":"E55",
"J14":"H55",
"L14":"I55",
"D15":"B56",
"E15":"C56",
"F15":"D56",
"H15":"E56",
"J15":"H56",
"L15":"I56",
"D16":"B70",
"E16":"C70",
"F16":"D70",
"H16":"E70",
"J16":"H70",
"L16":"I70",
"D17":"B66",
"E17":"C66",
"F17":"D66",
"H17":"E66",
"J17":"H66",
"L17":"I66",
"D18":"B68",
"E18":"C68",
"F18":"D68",
"H18":"E68",
"J18":"H68",
"L18":"I68",
"D19":"B69",
"E19":"C69",
"F19":"D69",
"H19":"E69",
"J19":"H69",
"L19":"I69",
"D20":"B71",
"E20":"C71",
"F20":"D71",
"H20":"E71",
"J20":"H71",
"L20":"I71",
"D22":"B77",
"E22":"C77",
"F22":"D77",
"H22":"E77",
"J22":"H77",
"L22":"I77",
"D23":"B74",
"E23":"C74",
"F23":"D74",
"H23":"E74",
"J23":"H74",
"L23":"I74",
"D24":"B86",
"E24":"C86",
"F24":"D86",
"H24":"E86",
"J24":"H86",
"L24":"I86",
"D25":"B80",
"E25":"C80",
"F25":"D80",
"H25":"E80",
"J25":"H80",
"L25":"I80",
"D26":"B81",
"E26":"C81",
"F26":"D81",
"H26":"E81",
"J26":"H81",
"L26":"I81",
"D27":"B84",
"E27":"C84",
"F27":"D84",
"H27":"E84",
"J27":"H84",
"L27":"I84",
"D28":"B91",
"E28":"C91",
"F28":"D91",
"H28":"E91",
"J28":"H91",
"L28":"I91",
"D29":"B92",
"E29":"C92",
"F29":"D92",
"H29":"E92",
"J29":"H92",
"L29":"I92",
"D30":"B104",
"E30":"C104",
"F30":"D104",
"H30":"E104",
"J30":"H104",
"L30":"I104",
"D31":"B96",
"E31":"C96",
"F31":"D96",
"H31":"E96",
"J31":"H96",
"L31":"I96",
"D32":"B97",
"E32":"C97",
"F32":"D97",
"H32":"E97",
"J32":"H97",
"L32":"I97",
"D33":"B100",
"E33":"C100",
"F33":"D100",
"H33":"E100",
"J33":"H100",
"L33":"I100",
"D34":"B101",
"E34":"C101",
"F34":"D101",
"H34":"E101",
"J34":"H101",
"L34":"I101",
"D35":"B102",
"E35":"C102",
"F35":"D102",
"H35":"E102",
"J35":"H102",
"L35":"I102",
"D36":"B109",
"E36":"C109",
"F36":"D109",
"H36":"E109",
"J36":"H109",
"L36":"I109",
"D37":"B107",
"E37":"C107",
"F37":"D107",
"H37":"E107",
"J37":"H107",
"L37":"I107",
"D38":"B108",
"E38":"C108",
"F38":"D108",
"H38":"E108",
"J38":"H108",
"L38":"I108",
"D39":"B115",
"E39":"C115",
"F39":"D115",
"H39":"E115",
"J39":"H115",
"L39":"I115",
"D40":"B113",
"E40":"C113",
"F40":"D113",
"H40":"E113",
"J40":"H113",
"L40":"I113",
"D41":"B121",
"E41":"C121",
"F41":"D121",
"H41":"E121",
"J41":"H121",
"L41":"I121",
"D42":"B122",
"E42":"C122",
"F42":"D122",
"H42":"E122",
"J42":"H122",
"L42":"I122",
"D45":"B118",
"E45":"C118",
"F45":"D118",
"H45":"E118",
"J45":"H118",
"L45":"I118",
"D46":"B119",
"E46":"C119",
"F46":"D119",
"H46":"E119",
"J46":"H119",
"L46":"I119",
"D47":"B120",
"E47":"C120",
"F47":"D120",
"H47":"E120",
"J47":"H120",
"L47":"I120",
"D48":"B125",
"E48":"C125",
"F48":"D125",
"H48":"E125",
"J48":"H125",
"L48":"I125",
"D49":"B130",
"E49":"C130",
"F49":"D130",
"H49":"E130",
"J49":"H130",
"L49":"I130",
"D50":"B139",
"E50":"C139",
"F50":"D139",
"H50":"E139",
"J50":"H139",
"L50":"I139",
"D51":"B134",
"E51":"C134",
"F51":"D134",
"H51":"E134",
"J51":"H134",
"L51":"I134",
"D52":"B135",
"E52":"C135",
"F52":"D135",
"H52":"E135",
"J52":"H135",
"L52":"I135",
"D53":"B146",
"E53":"C146",
"F53":"D146",
"H53":"E146",
"J53":"H146",
"L53":"I146",
"D54":"B161",
"E54":"C161",
"F54":"D161",
"H54":"E161",
"J54":"H161",
"L54":"I161",
"D55":"B165",
"E55":"C165",
"F55":"D165",
"H55":"E165",
"J55":"H165",
"L55":"I165",
"D56":"B175",
"E56":"C175",
"F56":"D175",
"H56":"E175",
"J56":"H175",
"L56":"I175",
"D57":"B173",
"E57":"C173",
"F57":"D173",
"H57":"E173",
"J57":"H173",
"L57":"I173",
"D58":"B200",
"E58":"C200",
"F58":"D200",
"H58":"E200",
"J58":"H200",
"L58":"I200",
"D59":"B201",
"E59":"C201",
"F59":"D201",
"H59":"E201",
"J59":"H201",
"L59":"I201",
"D60":"B198",
"E60":"C198",
"F60":"D198",
"H60":"E198",
"J60":"H198",
"L60":"I198",
"D61":"B205",
"E61":"C205",
"F61":"D205",
"H61":"E205",
"J61":"H205",
"L61":"I205",
"D62":"B206",
"E62":"C206",
"F62":"D206",
"H62":"E206",
"J62":"H206",
"L62":"I206",
"D63":"B208",
"E63":"C208",
"F63":"D208",
"H63":"E208",
"J63":"H208",
"L63":"I208",
"D65":"B211",
"E65":"C211",
"F65":"D211",
"H65":"E211",
"J65":"H211",
"L65":"I211",
"D66":"B223",
"E66":"C223",
"F66":"D223",
"H66":"E223",
"J66":"H223",
"L66":"I223",
"D67":"B234",
"E67":"C234",
"F67":"D234",
"H67":"E234",
"J67":"H234",
"L67":"I234",
"D68":"B238",
"E68":"C238",
"F68":"D238",
"H68":"E238",
"J68":"H238",
"L68":"I238",
"D69":"B239",
"E69":"C239",
"F69":"D239",
"H69":"E239",
"J69":"H239",
"L69":"I239",
"D70":"B240",
"E70":"C240",
"F70":"D240",
"H70":"E240",
"J70":"H240",
"L70":"I240",
"D71":"B241",
"E71":"C241",
"F71":"D241",
"H71":"E241",
"J71":"H241",
"L71":"I241",
"D72":"B248",
"E72":"C248",
"F72":"D248",
"H72":"E248",
"J72":"H248",
"L72":"I248",
"D73":"B260",
"E73":"C260",
"F73":"D260",
"H73":"E260",
"J73":"H260",
"L73":"I260",
"D74":"B272",
"E74":"C272",
"F74":"D272",
"H74":"E272",
"J74":"H272",
"L74":"I272",
"D75":"B279",
"E75":"C279",
"F75":"D279",
"H75":"E279",
"J75":"H279",
"L75":"I279",
"D76":"B276",
"E76":"C276",
"F76":"D276",
"H76":"E276",
"J76":"H276",
"L76":"I276",
"D77":"B288",
"E77":"C288",
"F77":"D288",
"H77":"E288",
"J77":"H288",
"L77":"I288",
"D78":"B282",
"E78":"C282",
"F78":"D282",
"H78":"E282",
"J78":"H282",
"L78":"I282",
"D79":"B283",
"E79":"C283",
"F79":"D283",
"H79":"E283",
"J79":"H283",
"L79":"I283",
"D80":"B286",
"E80":"C286",
"F80":"D286",
"H80":"E286",
"J80":"H286",
"L80":"I286",
"D81":"B306",
"E81":"C306",
"F81":"D306",
"H81":"E306",
"J81":"H306",
"L81":"I306",
"D82":"B298",
"E82":"C298",
"F82":"D298",
"H82":"E298",
"J82":"H298",
"L82":"I298",
"D83":"B302",
"E83":"C302",
"F83":"D302",
"H83":"E302",
"J83":"H302",
"L83":"I302",
"D84":"B311",
"E84":"C311",
"F84":"D311",
"H84":"E311",
"J84":"H311",
"L84":"I311",
"D85":"B317",
"E85":"C317",
"F85":"D317",
"H85":"E317",
"J85":"H317",
"L85":"I317",
"D86":"B323",
"E86":"C323",
"F86":"D323",
"H86":"E323",
"J86":"H323",
"L86":"I323",
"D87":"B341",
"E87":"C341",
"F87":"D341",
"H87":"E341",
"J87":"H341",
"L87":"I341",
"D88":"B348",
"E88":"C348",
"F88":"D348",
"H88":"E348",
"J88":"H348",
"L88":"I348",
"D89":"B402",
"E89":"C402",
"F89":"D402",
"H89":"E402",
"J89":"H402",
"L89":"I402",
"D90":"B212",
"E90":"C212",
"F90":"D212",
"H90":"E212",
"J90":"H212",
"L90":"I212",
}




if __name__ == "__main__":
    main()
