import streamlit as st
import xlwings as xw
import os
import tempfile

def main():
    st.title('RREO-03-Integrador')

   
    arquivo_xls_origem = st.file_uploader('Relatório sicof', type=['xls', 'xlsx'])
    arquivo_xls_destino = st.file_uploader('planilha vazia do siconfi', type=['xls', 'xlsx'])

    nome_arquivo_copia = st.text_input('Nome do arquivo de cópia:', 'RREO-03.xls')

    if st.button('Transferir Dados') and arquivo_xls_origem and arquivo_xls_destino:
        with tempfile.NamedTemporaryFile(delete=False, suffix='.xls') as tmp_origem:
            tmp_origem.write(arquivo_xls_origem.getvalue())
            caminho_xls_origem = tmp_origem.name

        with tempfile.NamedTemporaryFile(delete=False, suffix='.xls') as tmp_destino:
            tmp_destino.write(arquivo_xls_destino.getvalue())
            caminho_xls_original = tmp_destino.name

        caminho_pasta = tempfile.gettempdir()
        caminho_xls_copia = os.path.join(caminho_pasta, nome_arquivo_copia)

       
        app = xw.App(visible=False)
        wb_destino = app.books.open(caminho_xls_original)
        sheet_destino = wb_destino.sheets['RREO-Anexo 03']

        
        wb_origem = app.books.open(caminho_xls_origem)
        sheet_origem = wb_origem.sheets[0]  

        
        for origem, destino in mapeamento.items():
            valor = sheet_origem.range(origem).value
            sheet_destino.range(destino).value = valor

        
        wb_destino.save(caminho_xls_copia)
        wb_destino.close()
        wb_origem.close()
        app.quit()

        
        with open(caminho_xls_copia, "rb") as file:
            btn = st.download_button(
                label="Download arquivo copiado",
                data=file,
                file_name=nome_arquivo_copia,
                mime="application/vnd.ms-excel"
            )
        st.success('Dados transferidos com sucesso.')

mapeamento = {
    "B9":"B21",
"C9":"C21",
"E9":"D21",
"F9":"E21",
"G9":"F21",
"H9":"G21",
"I9":"H21",
"J9":"I21",
"K9":"J21",
"L9":"K21",
"M9":"L21",
"N9":"M21",
"P9":"N21",
"S9":"O21",
"B10":"B22",
"C10":"C22",
"E10":"D22",
"F10":"E22",
"G10":"F22",
"H10":"G22",
"I10":"H22",
"J10":"I22",
"K10":"J22",
"L10":"K22",
"M10":"L22",
"N10":"M22",
"P10":"N22",
"S10":"O22",
"B11":"B23",
"C11":"C23",
"E11":"D23",
"F11":"E23",
"G11":"F23",
"H11":"G23",
"I11":"H23",
"J11":"I23",
"K11":"J23",
"L11":"K23",
"M11":"L23",
"N11":"M23",
"P11":"N23",
"S11":"O23",
"B12":"B24",
"C12":"C24",
"E12":"D24",
"F12":"E24",
"G12":"F24",
"H12":"G24",
"I12":"H24",
"J12":"I24",
"K12":"J24",
"L12":"K24",
"M12":"L24",
"N12":"M24",
"P12":"N24",
"S12":"O24",
"B13":"B25",
"C13":"C25",
"E13":"D25",
"F13":"E25",
"G13":"F25",
"H13":"G25",
"I13":"H25",
"J13":"I25",
"K13":"J25",
"L13":"K25",
"M13":"L25",
"N13":"M25",
"P13":"N25",
"S13":"O25",
"B14":"B26",
"C14":"C26",
"E14":"D26",
"F14":"E26",
"G14":"F26",
"H14":"G26",
"I14":"H26",
"J14":"I26",
"K14":"J26",
"L14":"K26",
"M14":"L26",
"N14":"M26",
"P14":"N26",
"S14":"O26",
"B15":"B27",
"C15":"C27",
"E15":"D27",
"F15":"E27",
"G15":"F27",
"H15":"G27",
"I15":"H27",
"J15":"I27",
"K15":"J27",
"L15":"K27",
"M15":"L27",
"N15":"M27",
"P15":"N27",
"S15":"O27",
"B16":"B28",
"C16":"C28",
"E16":"D28",
"F16":"E28",
"G16":"F28",
"H16":"G28",
"I16":"H28",
"J16":"I28",
"K16":"J28",
"L16":"K28",
"M16":"L28",
"N16":"M28",
"P16":"N28",
"S16":"O28",
"B17":"B29",
"C17":"C29",
"E17":"D29",
"F17":"E29",
"G17":"F29",
"H17":"G29",
"I17":"H29",
"J17":"I29",
"K17":"J29",
"L17":"K29",
"M17":"L29",
"N17":"M29",
"P17":"N29",
"S17":"O29",
"B18":"B34",
"C18":"C34",
"E18":"D34",
"F18":"E34",
"G18":"F34",
"H18":"G34",
"I18":"H34",
"J18":"I34",
"K18":"J34",
"L18":"K34",
"M18":"L34",
"N18":"M34",
"P18":"N34",
"S18":"O34",
"B19":"B35",
"C19":"C35",
"E19":"D35",
"F19":"E35",
"G19":"F35",
"H19":"G35",
"I19":"H35",
"J19":"I35",
"K19":"J35",
"L19":"K35",
"M19":"L35",
"N19":"M35",
"P19":"N35",
"S19":"O35",
"B20":"B36",
"C20":"C36",
"E20":"D36",
"F20":"E36",
"G20":"F36",
"H20":"G36",
"I20":"H36",
"J20":"I36",
"K20":"J36",
"L20":"K36",
"M20":"L36",
"N20":"M36",
"P20":"N36",
"S20":"O36",
"B21":"B37",
"C21":"C37",
"E21":"D37",
"F21":"E37",
"G21":"F37",
"H21":"G37",
"I21":"H37",
"J21":"I37",
"K21":"J37",
"L21":"K37",
"M21":"L37",
"N21":"M37",
"P21":"N37",
"S21":"O37",
"B22":"B38",
"C22":"C38",
"E22":"D38",
"F22":"E38",
"G22":"F38",
"H22":"G38",
"I22":"H38",
"J22":"I38",
"K22":"J38",
"L22":"K38",
"M22":"L38",
"N22":"M38",
"P22":"N38",
"S22":"O38",
"B23":"B39",
"C23":"C39",
"E23":"D39",
"F23":"E39",
"G23":"F39",
"H23":"G39",
"I23":"H39",
"J23":"I39",
"K23":"J39",
"L23":"K39",
"M23":"L39",
"N23":"M39",
"P23":"N39",
"S23":"O39",
"B24":"B40",
"C24":"C40",
"E24":"D40",
"F24":"E40",
"G24":"F40",
"H24":"G40",
"I24":"H40",
"J24":"I40",
"K24":"J40",
"L24":"K40",
"M24":"L40",
"N24":"M40",
"P24":"N40",
"S24":"O40",
"B25":"B41",
"C25":"C41",
"E25":"D41",
"F25":"E41",
"G25":"F41",
"H25":"G41",
"I25":"H41",
"J25":"I41",
"K25":"J41",
"L25":"K41",
"M25":"L41",
"N25":"M41",
"P25":"N41",
"S25":"O41",
"B26":"B42",
"C26":"C42",
"E26":"D42",
"F26":"E42",
"G26":"F42",
"H26":"G42",
"I26":"H42",
"J26":"I42",
"K26":"J42",
"L26":"K42",
"M26":"L42",
"N26":"M42",
"P26":"N42",
"S26":"O42",
"B27":"B43",
"C27":"C43",
"E27":"D43",
"F27":"E43",
"G27":"F43",
"H27":"G43",
"I27":"H43",
"J27":"I43",
"K27":"J43",
"L27":"K43",
"M27":"L43",
"N27":"M43",
"P27":"N43",
"S27":"O43",
"B28":"B44",
"C28":"C44",
"E28":"D44",
"F28":"E44",
"G28":"F44",
"H28":"G44",
"I28":"H44",
"J28":"I44",
"K28":"J44",
"L28":"K44",
"M28":"L44",
"N28":"M44",
"P28":"N44",
"S28":"O44",
"B29":"B45",
"C29":"C45",
"E29":"D45",
"F29":"E45",
"G29":"F45",
"H29":"G45",
"I29":"H45",
"J29":"I45",
"K29":"J45",
"L29":"K45",
"M29":"L45",
"N29":"M45",
"P29":"N45",
"S29":"O45",
"B30":"B46",
"C30":"C46",
"E30":"D46",
"F30":"E46",
"G30":"F46",
"H30":"G46",
"I30":"H46",
"J30":"I46",
"K30":"J46",
"L30":"K46",
"M30":"L46",
"N30":"M46",
"P30":"N46",
"S30":"O46",
"B31":"B48",
"C31":"C48",
"E31":"D48",
"F31":"E48",
"G31":"F48",
"H31":"G48",
"I31":"H48",
"J31":"I48",
"K31":"J48",
"L31":"K48",
"M31":"L48",
"N31":"M48",
"P31":"N48",
"S31":"O48",
"B32":"B47",
"C32":"C47",
"E32":"D47",
"F32":"E47",
"G32":"F47",
"H32":"G47",
"I32":"H47",
"J32":"I47",
"K32":"J47",
"L32":"K47",
"M32":"L47",
"N32":"M47",
"P32":"N47",
"S32":"O47",
"B33":"B49",
"C33":"C49",
"E33":"D49",
"F33":"E49",
"G33":"F49",
"H33":"G49",
"I33":"H49",
"J33":"I49",
"K33":"J49",
"L33":"K49",
"M33":"L49",
"N33":"M49",
"P33":"N49",
"S33":"O49",
"B34":"B50",
"C34":"C50",
"E34":"D50",
"F34":"E50",
"G34":"F50",
"H34":"G50",
"I34":"H50",
"J34":"I50",
"K34":"J50",
"L34":"K50",
"M34":"L50",
"N34":"M50",
"P34":"N50",
"S34":"O50",
"B35":"B51",
"C35":"C51",
"E35":"D51",
"F35":"E51",
"G35":"F51",
"H35":"G51",
"I35":"H51",
"J35":"I51",
"K35":"J51",
"L35":"K51",
"M35":"L51",
"N35":"M51",
"P35":"N51",
"S35":"O51",
"B37":"B52",
"C37":"C52",
"E37":"D52",
"F37":"E52",
"G37":"F52",
"H37":"G52",
"I37":"H52",
"J37":"I52",
"K37":"J52",
"L37":"K52",
"M37":"L52",
"N37":"M52",
"P37":"N52",
"S37":"O52",
"B39":"B53",
"C39":"C53",
"E39":"D53",
"F39":"E53",
"G39":"F53",
"H39":"G53",
"I39":"H53",
"J39":"I53",
"K39":"J53",
"L39":"K53",
"M39":"L53",
"N39":"M53",
"P39":"N53",
"S39":"O53",

}

if __name__ == "__main__":
    main()
